<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">

<script language="javascript" type="text/javascript">
  var smartDonationsOldJQuery=jQuery;
  var smartDonationsOldCashSign=$;
</script>

<link rel="import" href="../ch-externallibraries/jquery-2.2.3.html">
<link rel="import" href="../ch-externallibraries/devextreme.html">

<script language="javascript" type="text/javascript">
  var jq223=jQuery;
  window.jQuery =smartDonationsOldJQuery;
  window.$ = smartDonationsOldCashSign;

  console.log(jQuery.fn.jquery);
</script>


<dom-module id="ch-grid">
  <style>
    :host { display: block; }
  </style>

  <template>

    <h2>{{title}}</h2>
    <div id="gridContainer"></div>
  </template>
  <script>
    Polymer({
      is: 'ch-grid',

      properties: {
        dg:{
          type:Object
        },
        title:{
          type:String,
          value:'Data Grid'
        },
        columns:{
          type:Array,
          value:['CompanyName', 'City', 'State'],
          observer:'_columnsChanged'
        },
        datasource:{
          type:Array,
          value:[{CompanyName:'CloudHub', City:'Nairobi', State:'Kenya', Phone:'Nil', Fax:'Nil'}]
        },
        pgsize:{
          type:Number,
          value:10
        },
        search:{
          type:Boolean,
          value:true
        },
        exportenabled:{
          type:Boolean,
          value:true
        },
        exportname:{
          type:String,
          value:'gridexport'
        }

      },

      ready: function() {

      },

      drawGrid:function () {
        var node=this.$.gridContainer;

        var grid = jq223(node).dxDataGrid({
          dataSource: this.datasource,
          columns: this.columns,
          paging: {
            pageSize: this.pgsize
          },
          pager: {
            showPageSizeSelector: true,
            allowedPageSizes: [5, 10, 20],
            showInfo: true
          },
          allowColumnResizing: true,
          columnChooser: { enabled: true },
          allowColumnReordering: true,
          sorting: { mode: 'multiple' },
          groupPanel: { visible: true, emptyPanelText: 'Drag a column header here to group grid records' },
          bindingOptions: {

          },
          searchPanel: { visible: this.search },
          selection: { mode: 'multiple'},
          export:{
            enabled:this.exportenabled,
            fileName:this.exportname,
            allowExportSelectedData:true
          }
        });

      },

      attached: function() {
        //this.drawGrid();
      },

      _columnsChanged:function(){
        this.drawGrid();
      },

      detached: function() {
        // The analog to `attached`, `detached` fires when the element has been
        // removed from a document.
        //
        // Use this to clean up anything you did in `attached`.
      },

    });
  </script>
</dom-module>